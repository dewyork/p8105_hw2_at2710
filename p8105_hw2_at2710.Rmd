---
title: "Homework 2"
author: "Anusorn Thanataveerat"
date: '2018-09-25'
output:
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

# Problem 1

Read and clean the data; retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (YES vs NO) to a logical variable

```{r Load_Package, include = FALSE, message = FALSE}
library(tidyverse)
library(gridExtra)
library(janitor)
```
```{r problem_1, message = FALSE}
original_dat <-
  read_csv(
  'http://p8105.com/data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv'
  ) %>% clean_names()
  
  subset_dat <-
  original_dat %>% select(line:entry, vending, ada, ada_notes) %>%
  mutate(entry = ifelse(entry == 'YES', TRUE, FALSE))
  dedup_subset_dat <-
  subset_dat %>% arrange(line, station_name, desc(ada)) %>%  distinct(line, station_name, .keep_all = TRUE) 
```

Write a short paragraph about this dataset â€“ explain briefly what variables the dataset contains, describe your data cleaning steps so far, and give the dimension (rows x columns) of the resulting dataset. Are these data tidy?

**Answer**:Once downloaded, the data set consists of `r ncol(original_dat)` variables and `r nrow(original_dat)` observations. These are information on all the entrace to all the subway stations in NYC so each station could have multiple rows of information depending on the number of entrance. We further included only the variables as suggested and the number of variables came down to `r ncol(subset_dat)`. At this point, we noticed rows with identical input of a combination of *line* and *station name* thus we de-duplicated based on those two variables and ended up with **`r nrow(dedup_subset_dat)`** unique stations in the NYC subway system. There are `r sum(dedup_subset_dat$ada)` stations (`r round(100* sum(dedup_subset_dat$ada)/nrow(dedup_subset_dat),2)` %) which are ADA compliant. Also,
`r round(100*dedup_subset_dat %>% filter(vending == 'NO' & entry == TRUE) %>% nrow()/nrow(dedup_subset_dat),2)`% and `r round(100*dedup_subset_dat %>% filter(vending == 'NO' & entry == TRUE) %>% nrow()/nrow(dedup_subset_dat),2)`%
What proportion of station entrances / exits without vending allow entrance?

Reformat data so that route number and route name are distinct variables. How many distinct stations serve the A train? How many are ADA compliant?
```{r}
reformat_dedup_subset <- dedup_subset_dat %>% mutate_if(is.integer, as.character) %>%   mutate(trains = paste(route1, route2, route3, route4, route5, route6,
  route7, route8, route9, route10,route11)) %>% mutate(trains = 
  gsub('NA', '', trains)) %>% mutate(A_train = str_detect(trains, "A"))
```

**Answer**: There are `r sum(reformat_dedup_subset$A_train)` stations that the A train serves `r reformat_dedup_subset %>% filter(A_train == TRUE & ada == TRUE) %>% nrow()` of which are ADA compliant.

# Problem 2



